<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>학생정보</title>
</head>
<body>
    <h1>학생 정보</h1>
    <table>
        <thead>
            <th>id</th>
            <th>name</th>
            <th>number</th>
        </thead>
        <tbody id="body">

        </tbody>
    </table>
    <div id="btns">
        
    </div>
    <script>
        const getData = async (page = 0) =>{
            const response = await fetch(
                `http://192.168.0.184:8080/api/v1/member?page=${page}`)
            const body = await response.json() 
            return body
        }
        const makeButtons = (totalPages) => {
            const btns = document.getElementById("btns")
            for(let i=0; i< totalPages; i++){
                const btn = document.createElement("button")
                // <button></button>
                btn.innerText = i + 1
                // <button>1</button>
                btn.addEventListener("click", ()=>changePage(i))
                // <button onclick="getData(1)">1</button>
                btns.appendChild(btn)
            }
        }
        const changePage = async (i)=>{
            const students =  await getData(i)
            makeBody(students.content)
        }
        const makeBody = (content) =>{
            const body = document.getElementById("body")
            body.innerHTML = ''
            content.forEach(element => {
                    body.innerHTML += 
                    `<tr>
                        <td>${element.id}</td>
                        <td>${element.name}</td>
                        <td>${element.number}</td>
                        </tr>`
            });
        }
        const init = async () => {
            const {totalPages, content} = await getData()
            makeButtons(totalPages)
            makeBody(content)
        }
        init()
    </script>
</body>
</html>